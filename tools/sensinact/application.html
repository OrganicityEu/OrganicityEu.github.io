<!DOCTYPE html>
<html>
<head>
  <meta http-equiv="content-type" content="text/html; charset=UTF-8">
  <meta charset="utf-8">
  <meta http-equiv="X-UA-Compatible" content="IE=edge,chrome=1">
  <title>SensiNact | OrganiCity</title>
  <meta name="viewport" content="width=device-width, initial-scale=1">

  <!-- Standard Favicon -->
  <link rel="shortcut icon" type="image/x-icon" href="http://organicity.eu/wp-content/themes/organicity/favicon.ico">
  <!-- For iPhone: -->
  <link rel="apple-touch-icon-precomposed" href="http://organicity.eu/wp-content/themes/organicity/apple-touch-icon-precomposed.png">
  <link rel="stylesheet" href="stylesheets/stylesheet.css">
</head>

<body>

<header>
  <a href="http://organicity.eu/" title="OrganiCity - link to homepage">
    <img src="images/organicity_logo.png" alt="Organicity">
  </a>
</header>

<div class="title">
  <h1>SensiNact</h1>
  <nav>
    <a href="index.html">Introduction</a> |
    <a href="install.html">Installation</a> |
    <a href="studio.html">Studio</a> |
    <a href="application.html">Application management</a> |
    <a href="gateway.html">Gateway</a>
  </nav>
</div>


<div class="content">

<h2>Application management</h2>

<h3>Application creation</h3>

<img src="images/app-creation.png"/>

<p>The SensiNact Studio allows the creation of applications to be executed on the gateway. Creating an application is performed by writing a script using a dedicated syntax, and deploying this script to the gateway.</p>

<p>On the figure above, a project has been created on the project explorer view (on the left). In this project, a script named speed-limit.sna has been created, and is being edited. As the figures shows, the editor provides code highlighting (some keywords are displayed in a special font), code completion (with popups) and a syntax validator which displays red crosses on the script margin in case of error.</p>

<p>The dedicated syntax, a Domain Specific Language, is composed by the following blocks:</p>

<ul>
  <li><strong>The shortcut block:</strong> each resource is accessible through a unique URI, which can be quite long. This block aims at creating shortcut for the next blocks.</li>
  <li><strong>The event block:</strong> the developer defines on which resources the application is triggered. When an event is thrown and is a valid trigger, the conditional block is executed.</li>
  <li><strong>The conditional block:</strong> once the application has been triggered, and before any action can be executed, the data from the resource has to satisfy the conditional block. The keyword for this block is if followed by the conditions to be validated.</li>
  <li><strong>The actions statements:</strong> if the conditional block is satisfied, actions are performed in the order that they are listed. The actions can be physical actions on actuators or virtual actions such as changing the format of a data using a mathematical function. The available actions, also named functions, are listed below:</li>
  <ul>
    <li><strong>Basic functions:</strong> addition, subtraction, division, multiplication, modulo, string concatenation, substring, various operators (e.g., equals, greater than, lesser than, different), ACT and SET methods on sensiNact resources.</li>
    <li><strong>Complex Event Processing functions (using the Esper1 library):</strong> after, before, coincides, average, average deviation, count, max, min, median, standard deviation and sum.</li>
  </ul>
</ul>

<p>The following table shows the basic structure for writing a script.</p>

<table>
<tr>
  <td>[resource <resource>]+</td>
  <td>Shortcut block, which must contains at least one statement.</td>
</tr>
<tr>
  <td>on <events>+</td>
  <td>The event block, lists the events triggering the script. At least one event must be provided.</td>
</tr>
<tr>
  <td>[if <condition> do]+<br>[<actions>]+<br>[else do]?<br>[<actions>]?+<br>end if;</td>
  <td>The conditional block, which lists actions to be performed based on conditions.</td>
</tr>
</table>

<p>Once the script has been written, it can be deployed to the gateway where it will be executed. This is performed using a right click on the script file.</p>

<img src="images/app-deployment.png"/>

<h3>Application monitoring</h3>

<p>After the application has been deployed, a new set of resources is automatically created under the AppManager device. You can browse those resources into the Device Navigator View.</p>

<img src="images/app-resources.png"/>

<p>First of all, a new service is created with the name of the sna file (without the extension). In our example, it is speed-limit. This service representing the application always contains a standard set of resources.</p>

<table>
<thead>
  <tr>
    <th>Resource</th>
    <th>Type</th>
    <th>Description</th>
  </tr>
</thead>
<tr>
  <td>autorestart</td>
  <td>property</td>
  <td>In case of failure, decides if the application should be automatically started again</td>
</tr>
<tr>
  <td>content</td>
  <td>property</td>
  <td>Script file content</td>
</tr>
<tr>
  <td>EXCEPTION</td>
  <td>action</td>
  <td>Deprecated</td>
</tr>
<tr>
  <td>location</td>
  <td>property</td>
  <td>GPS location which can be used if it makes sense </td>
</tr>
<tr>
  <td>maxinstances</td>
  <td>property</td>
  <td>Number of parallel instances which should be started</td>
</tr>
<tr>
  <td>resetOnStop</td>
  <td>property</td>
  <td>On Stop, decides if the generated resources by the application should be destroyed or kept</td>
</tr>
<tr>
  <td>START</td>
  <td>action</td>
  <td>Starts the application</td>
</tr>
<tr>
  <td>status</td>
  <td>state variable</td>
  <td>Current status of the application: START/STOP/...</td>
</tr>
<tr>
  <td>STOP</td>
  <td>action</td>
  <td>Stops the application</td>
</tr>
<tr>
  <td>UNINSTALL</td>
  <td>action</td>
  <td>Removes the application</td>
</tr>
</table>

<p>To start the application, simply double click on the START resource. This will launch the start action, which will run the script.</p>

<img src="images/app-startup.png"/>

<p>The figure shows that the application is up and running on the server. The studio can be used to check if the application has the expected behavior, by querying the resources. The studio can also be shutted down, since the applications are executed on the gateway, which will be presented in paragraph 4.3 (sensiNact Gateway). </p>

<h3>Conclusion</h3>

<p>In this section, we have presented the way sensiNact Studio can gives an overview of the available devices in the OrganiCity  context. We have also shown the creation process of IoT application following the Event-Condition-Action (ECA) pattern.</p>

</div>

<footer>&copy; Organicity 2016</footer>

</body>

</html>
